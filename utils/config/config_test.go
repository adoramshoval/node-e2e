package config

import (
	"context"
	"fmt"
	"os"
	"testing"

	"sigs.k8s.io/e2e-framework/pkg/env"
	"sigs.k8s.io/e2e-framework/pkg/envconf"
	"sigs.k8s.io/e2e-framework/pkg/features"
)

const (
	namespace string = "default"
)

var testsEnvironment env.Environment

func TestMain(m *testing.M) {
	// create config from flags (always in TestMain or init handler of the package before calling envconf.NewFromFlags())
	// This is needed in order to initilize flags provided by the e2e-framework module
	cfg, err := envconf.NewFromFlags()
	if err != nil {
		fmt.Printf("failed to build envconf from flags: %s", err)
		os.Exit(1)
	}
	testsEnvironment = env.NewWithConfig(cfg)

	testsEnvironment.Setup(func(ctx context.Context, config *envconf.Config) (context.Context, error) {

		return ctx, nil
	})

	// Don't forget to launch the package test
	os.Exit(testsEnvironment.Run(m))
}

func TestKubeConfigFromFlags(t *testing.T) {
	feat := features.New("KubeConfig from flags").
		WithLabel("type", "Config").
		Assess("Test creating a KubeConfig file from provided flags", func(ctx context.Context, t *testing.T, c *envconf.Config) context.Context {
			a := New()
			a.WithNamespace(namespace)

			kcPath, err := NewKubeConfigFromFlags(a)
			if err != nil {
				t.Fatal(err)
			}

			t.Logf("Path of the created KubeConfig file: %s", kcPath)
			return ctx
		}).Feature()

	testsEnvironment.Test(t, feat)
}

func TestKubeConfigFromStruct(t *testing.T) {
	feat := features.New("KubeConfig from struct").
		WithLabel("type", "Config").
		Assess("Test creating a KubeConfig file from provided struct attributes", func(ctx context.Context, t *testing.T, c *envconf.Config) context.Context {
			a := New()
			a.WithSAName("test-sa")
			a.WithSAToken("123")
			a.WithClusterEndpoint("https://api.medone-0.med.one:6443")
			a.WithCertificateAuthorityData("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURNakNDQWhxZ0F3SUJBZ0lJZWw0RGFnYXZscUl3RFFZSktvWklodmNOQVFFTEJRQXdOekVTTUJBR0ExVUUKQ3hNSmIzQmxibk5vYVdaME1TRXdId1lEVlFRREV4aHJkV0psTFdGd2FYTmxjblpsY2kxc1lpMXphV2R1WlhJdwpIaGNOTWpJeE1qQXhNVEl3T0RBeFdoY05Nekl4TVRJNE1USXdPREF4V2pBM01SSXdFQVlEVlFRTEV3bHZjR1Z1CmMyaHBablF4SVRBZkJnTlZCQU1UR0d0MVltVXRZWEJwYzJWeWRtVnlMV3hpTFhOcFoyNWxjakNDQVNJd0RRWUoKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTUFZM1krK25SNkxOQnJIUUxQRXpNN3pleFI3U2JEbgpkTmcrOVY5SUx6TVpqbmYwNTMvSzZtR2NIcDlrRWJYK0owMHVhV2FuZGJMSmdrL3ZMczhOZXBQeWM5MXJCOEJLCnJDVTluS2J2OVV3SmZ0RTZxU21lMFV3eHhIallQazJzSTQyNzdZeW1zc1pwQ1BIckFsWms5ampCTEtDdkxRQ3cKU0VYNzB2R3ZMbTVSRVBHalBwQjd4MzhXcUM4UkFvaCtFdHN6N1pHb0dEc1BpMUcxUHpsS2RsZFJrMHh0S0xGUwozb3A0d0xiRzdkNzQrVFp3b2ZTVGtIaEs5aFVqSUhOT1ZYOEpYWlNoWjZIMmZGSUt4QlRvY0VHZERDU2V6dy9mCmpxNjE1U3BUU2ltQzJMYlFZTy9KV2ZnZXBQa2lxeWZlbEdQMDNEbDJGajFSVWFOdloyYkhzZnNDQXdFQUFhTkMKTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRk0rbwpySVFJNkRWWXFCUGtrdFJIeFBucU1ESm1NQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUFvU1l5cTg1V0xjWWxCCjIyQ085YTZ2elN0VzcvVEFMV2RUTktDMEZmenJRZjdDNFBxdkJNamdlejk4ZTNvQzlHckxod0w1dlN0a2xZbmkKc1h6a0o2RSt1WlpzL3czVm1ybmhvSStqRyszaUx5ek5Ib2luaTd6UldIQzBHdURZYmhQb2FWZnpYYXBLbmpmTgo2QW9mMUlXMDE5Uk1zMWd0Rlo0UGJXd2U5TWZITVVwbE5JUDhXSXdGRWZXaytldkZKMmtMU3VKN1lDUFJXSTNKCkVlQ25qTldSbkFDMHdmd0N4OUliSnlqcjNacTlGdzJqOE5JaHcwbldOanNqK09aWDJIdVNQVlFBdEtUUW14QlYKclhsci95MkNKUmdGemtxcDl0aGF0QVllRDhuNG5jVjBWSFZxbEJvb0hXMTd0Z0FEalBRbVptaVd5WFNFNkIxdgpveFM1dERCMAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlEUURDQ0FpaWdBd0lCQWdJSWQ2WUljZDdGdFg4d0RRWUpLb1pJaHZjTkFRRUxCUUF3UGpFU01CQUdBMVVFCkN4TUpiM0JsYm5Ob2FXWjBNU2d3SmdZRFZRUURFeDlyZFdKbExXRndhWE5sY25abGNpMXNiMk5oYkdodmMzUXQKYzJsbmJtVnlNQjRYRFRJeU1USXdNVEV5TURnd01Wb1hEVE15TVRFeU9ERXlNRGd3TVZvd1BqRVNNQkFHQTFVRQpDeE1KYjNCbGJuTm9hV1owTVNnd0pnWURWUVFERXg5cmRXSmxMV0Z3YVhObGNuWmxjaTFzYjJOaGJHaHZjM1F0CmMybG5ibVZ5TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFvN0ZHcnk2UldDbG4KUXIwSmdDK2p0SHlkZlVHd00wdmRsWmVqdWozemszR3ZibGFWbzRnQjB3bUhBRWk3LzNKRWYvT0NVMnVCNUQxVgpVdWdMWm1XTEREV3l6RGJzNkRmVTRuMDdTTmNCN1RXamdGSnJlU0hCMzhrM2IxOU05cVZrN1g0VHBBcEMwUXlwCndqbytHelZPbnI4Z1ZucDU5dmFudHFNNXVNZlRRUEx0WWR3MjFzYWJGeEtFWThZa2VrK0dNalpPeWNwTE0xalAKaHkwZ3V1RTN5Uko4TXFJMmlNZWEwUjB3a2tvK3hvcy8wdUZ5S2dkRWRqMFVzRHR3TzlDN0hraGo2cXZ1ZTBsbwpYTHI5MEtISC9tZmE4cDBBTHd4M2tCUUxRb1RDclZZYUZ6RVhRZ1k4TU5mMmhUYmZ1VVEwNGpVM2NzbU0vcnB3CjYzMmFBV0JsaFFJREFRQUJvMEl3UURBT0JnTlZIUThCQWY4RUJBTUNBcVF3RHdZRFZSMFRBUUgvQkFVd0F3RUIKL3pBZEJnTlZIUTRFRmdRVTlJamx5bUxVOEtsakdXeUFBWXd6aWJrZTVnRXdEUVlKS29aSWh2Y05BUUVMQlFBRApnZ0VCQUZVZlk3K0hPcVVIT21jZ0xKS1hkcVM3bDN0MVRZZ29uZ1RKM29qQXVyTTlhaDFPSW55M2Z4aUFpcXJkCndTY0JoWjA2ZkZDU2VRSFhWWTFpQUpKNnoyYUdvM3I2K3IweVo0ZnhYcVhZQnNuL1E0R2wvM25nelc0NmJIemEKdytILzYwQzJScGNuYjZMQytlZ2puN0IrUm1xQy9mWWZSTEtacjhFOHRKL0tPNWZ2Z04yaUtIUk1iSGxHOFp2ZApaU3VSYkkvei9xZFBOVTVlTmxYVGpvWU9vNEREQ0E3VHlqWlJsUElSaUZ0OVZ4ZVFraG56aG40cVV2S2pUWVlvCnVmbnRQT0xyWi8vbnU0ei9WbGZXS0QwZktDUnJkV2ZPb2lpaisyRzNVdnRKa25TZlVwdG5wbjR0Tk11bUVIeUcKSEJUZkp0b1NUY2NPWGhLWFZIYkZ6aExORlZ3PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlEVERDQ0FqU2dBd0lCQWdJSVBqaW5ramE5SWZVd0RRWUpLb1pJaHZjTkFRRUxCUUF3UkRFU01CQUdBMVVFCkN4TUpiM0JsYm5Ob2FXWjBNUzR3TEFZRFZRUURFeVZyZFdKbExXRndhWE5sY25abGNpMXpaWEoyYVdObExXNWwKZEhkdmNtc3RjMmxuYm1WeU1CNFhEVEl5TVRJd01URXlNRGd3TVZvWERUTXlNVEV5T0RFeU1EZ3dNVm93UkRFUwpNQkFHQTFVRUN4TUpiM0JsYm5Ob2FXWjBNUzR3TEFZRFZRUURFeVZyZFdKbExXRndhWE5sY25abGNpMXpaWEoyCmFXTmxMVzVsZEhkdmNtc3RjMmxuYm1WeU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0MKQVFFQXAwb0tLVThPMlRqRlh1Wk8wdEtlUjVvMXJNN3RNb3dSdE8yZjJwZ1B2K0hUVjdwcHhPdHRLbFkzbjlxdwo5RHRXVExPVFhvVVo4blNONEJ3VUJ3WWFjaXdkbjhWWU8wbzF0RE5EZFg5YW9taFdKdUFhQzBhU2JjdlI0SlhKCjd5ZFNLbk9wTno0Z3JjbE01OUU5bVlXOVBEbVZzUDJDL3BaRHdXVnd1eVdZSmxDejNnVVA1ZmNRUThXdFVYaDUKTGtTekVHU0krMlRYV3pnR3JMdkRIbExXZXF3TVdKcDU3YzVaZERZcjVRWXVZTXhncDBuYzhJWVQ5NGlwRFpzVAphN0R2SnRpaEpFSy8vQ2hDVmNsMHJUeXBaMk1zVlF1RnViSEtncDhiSFl2b1ZmWm5pbmk1eFdRN3RKVFZ1eWFwCnlEaGhNYnM4RFVHb0FGN2kxaU0wMTJPMlZ3SURBUUFCbzBJd1FEQU9CZ05WSFE4QkFmOEVCQU1DQXFRd0R3WUQKVlIwVEFRSC9CQVV3QXdFQi96QWRCZ05WSFE0RUZnUVVxbW1HQTRLVXVJemNjYTFoZ09JdVZpU21nNWt3RFFZSgpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFEWjVMeGVnTkpHR1RTd2hnejlDTnVjbkJLMEJvOGFLbzhnSWVaZ1VuWEF1CmY0QWQ3aUdkK3V6bFd3UlY5T2U3ZEdhV1ExMjB4dnh2WVRrTXBQWkhTWmpDWXRaeExqQVV3Q05nNEtzb0pPR1MKbnZxK0tEalhMN1NHZm9tVFY3cXVrVHdyaGlSQm9OMmRoblQ1dnpFZXkvMUtFOHBKeDlvTk96d3psUi9TUlJveQp5akZQN3NCUURhRnJlZjNNcW03UnhNeFlTbWxDT1ZVTVBvMTVaVjgrL1lsWmhWdGtxc2ZycDF2ZGdKMnFtY2dKCkVINWxYSkJ3SmFtNmFLcmdDS2pNWXJSOSsrbFY5NGU4L2lKdzNjV0JxNmtKdHUrMWd5UjNERDhMN3g1ZEdIRFEKaFFacjlqeWNxZU9xSnVqRGx5NmI1VzRiVnlIWlZsekNRS3J6QUo0blYvWT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJRGx6Q0NBbitnQXdJQkFnSUlDM3NmckdiTGxMUXdEUVlKS29aSWh2Y05BUUVMQlFBd1dURlhNRlVHQTFVRQpBd3hPYjNCbGJuTm9hV1owTFd0MVltVXRZWEJwYzJWeWRtVnlMVzl3WlhKaGRHOXlYMnh2WTJGc2FHOXpkQzF5ClpXTnZkbVZ5ZVMxelpYSjJhVzVuTFhOcFoyNWxja0F4TmpZNU9EazROVFV5TUI0WERUSXlNVEl3TVRFeU5ESXoKTWxvWERUTXlNVEV5T0RFeU5ESXpNMW93V1RGWE1GVUdBMVVFQXd4T2IzQmxibk5vYVdaMExXdDFZbVV0WVhCcApjMlZ5ZG1WeUxXOXdaWEpoZEc5eVgyeHZZMkZzYUc5emRDMXlaV052ZG1WeWVTMXpaWEoyYVc1bkxYTnBaMjVsCmNrQXhOalk1T0RrNE5UVXlNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXE3d2QKQWJXdmNCQWpBSkIwendZL0hsbUJ0Mm5lUStqTy9pS1ZGZjdXV3dxYWkwNmhQSFFEdzZtOVZXM1lDOTY3KzNteQpwTFp3ZVNreERwYU9ZUnYyTTAydzZWYkVUeldmWWhvK2I0blYxc1Z0eFhydW5IRTh5SU9UaERGNnlJdm1RZTNiCjV1WUNZQmxCTGt3T3BCanFJQURla1ZBTEtIMU9XcE43U0M5ZlFaM1Z3YTRpcDhIbW1YWE9VVTNldm1NNlRXVmsKSGxzZi9vUngvaFpzZjgybWx4WFl2d21SdGF2Vmcvb2g4cmlPYkxJV2tYMmNhS0ZyN2VEUGRaMUR3SHpZZEpEdQptT0ptOWNKNU16citBMVd3WjdrM0pwbkpocjJqZ25IemZieXlpUytqbVRBaUo5N2d2YWpuWko0SUE5SzcweU5TCldidmVBYm45ejB6dllIcWp4UUlEQVFBQm8yTXdZVEFPQmdOVkhROEJBZjhFQkFNQ0FxUXdEd1lEVlIwVEFRSC8KQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVT3pZcXpTYS9LM2h4ODdTenhMckVJQmEzQlBvd0h3WURWUjBqQkJndwpGb0FVT3pZcXpTYS9LM2h4ODdTenhMckVJQmEzQlBvd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFKdThNNTFyCkZBY1NPd0xOdjJOZktVMmtWL0RzdHJkUEFYajlhY05hM3l1WjlvM3QyL1NzdGNrWEEzSkdJcG11WktTZnUrSlAKQ0dGamJNcnVlVlpZbXJiWS9LeFVsd2lRMWd2a3hNaFRkRURWaFVYd1JMb1BBUVExUTEvOFFROEphY283K3lSZgpuNndmdVJGQ3JkcFowcGhsZ2F5K29CU1MwZ3ZqbWxnNXNOSFFjSWJuVkdwK3YzTk9ndU5ZeDB2UUpGUGdxNDUzCjQ5dmZ4RUdGaXl2WUZqV3plK0NRMjZESHhCd2VsOFVNa2JnNWd0VmtnQUxCMXlZLzBteW9iMUg0cHBMT2FMK3QKRzE4a2xScGJRb1JXUTJkdm4waysvdGtaN2Q1UFN6WDBkbDlRNWs3d2tJVmZtaURscEFXZTdieFlMcFZxc0lyZwpmUDJEZFhtOGZzQ0Z0R2c9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVRVENDQXltZ0F3SUJBZ0lFTC80QUZ6QU5CZ2txaGtpRzl3MEJBUXNGQURBeU1SQXdEZ1lEVlFRS0RBZE4KUlVRdVQwNUZNUjR3SEFZRFZRUUREQlZEWlhKMGFXWnBZMkYwWlNCQmRYUm9iM0pwZEhrd0hoY05Nakl4TVRBeQpNRGN4TVRBeFdoY05NalF4TVRBeU1EY3hNVEF4V2pBeU1SQXdEZ1lEVlFRS0RBZE5SVVF1VDA1Rk1SNHdIQVlEClZRUUREQlZoY0hCekxtMWxaRzl1WlMweExtMWxaQzV2Ym1Vd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUIKRHdBd2dnRUtBb0lCQVFEUTJ2TWZYWGpzeVkrRXVYYytxQVFnamFydFBFMzFTNDM3Q0Z5KytQUUlCVEJYY21GdAp2YmY0d1NDV3BpRHE0d2lPTi9VcWM5eDdIUzdVOFZkemEza1VqSFc4Nmxna3ZtdnNGWjUrYldiVHVqckUzQ2d6Ck5CVTJ6dzFiM21xNEt4cU5Uajd6OUY5KzdtWW9TQ3dHdEl6TEZjSUdibFlGOWxmVFRXOGVzaGNLZDM2Nkx0TEYKL0dMejU0cWZZa0RLelF4VDhUUWxvQkpjanJ1U1BRTEN4aUJNMkNGOGkzR21BWFgrTzluMUVoV0ZTOVM3Y3JuYQovcDFUeStiazlHOWVSQThFbk1PZzhRS0E1UFN3bGhlVmJtVnVhYk00cEZLd1BiRFB0L3IwUDk3T2NPQlRJbXZxClhkRFE1SjBySXRlYU5zbHE2MW1nSldJalRoaXhnNi9SVUlHTEFnTUJBQUdqZ2dGZE1JSUJXVEFmQmdOVkhTTUUKR0RBV2dCU2pIUWx3ZDNzVmI4eXJLRS91bGhqY2Zab3RsREE1QmdnckJnRUZCUWNCQVFRdE1Dc3dLUVlJS3dZQgpCUVVITUFHR0hXaDBkSEE2THk5cGNHRXRZMkV1YldWa0xtOXVaUzlqWVM5dlkzTndNQTRHQTFVZER3RUIvd1FFCkF3SUU4REFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd2NnWURWUjBmQkdzd2FUQm4Kb0MrZ0xZWXJhSFIwY0RvdkwybHdZUzFqWVM1dFpXUXViMjVsTDJsd1lTOWpjbXd2VFdGemRHVnlRMUpNTG1KcApicUkwcERJd01ERU9NQXdHQTFVRUNnd0ZhWEJoWTJFeEhqQWNCZ05WQkFNTUZVTmxjblJwWm1sallYUmxJRUYxCmRHaHZjbWwwZVRBZEJnTlZIUTRFRmdRVVFQYkJDdlJkTHAyWXV4d05tL3ZsS0J4SExYWXdPUVlEVlIwUkJESXcKTUlJWEtpNWhjSEJ6TG0xbFpHOXVaUzB4TG0xbFpDNXZibVdDRldGd2NITXViV1ZrYjI1bExURXViV1ZrTG05dQpaVEFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBbFlCcFhhQXJPRGRzUnhBdXFJRjdTZlZ2NmpXU1VrOW5FVTh5CnR4U01FVjZ1Zy82RHlSZVVmWWQ0eGZGaVVsTnNTZGxwWUV5MnUvd3JPU1R6UllBQi82NHRWbXh5NUNnOEl6L08KOHBOMmVEZ1hETmJYODJ3a3YvQ1VuVXpqWkUvakdjOU10M0VBVXF4dW5MTU1JLzg3ZDMvdkZVU0NEUERVY1ZtdwpUWlJjUCttYWRWcmVvUC83Z1ZPU2lvQUNVQTJFQ2JXeWlXS0wydWQ1ZjlDaWx0cVpxV0E0UFJyaG5MVlhHMW8wCnRyS3dqOGxyVWtYQkphdE1hSDFtNTJsaDhvZFJCUEhJNXNhSkF6RGxEdXphcTgrcmI1Y0NmNVNBcUR6UzhMcG8KWHJoOGFycFpuVFBROTJhMEd0YnFReU5QUTBPSVhKa1R0V0ZiL21QTUgrQVhVOW13NEE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlEZnpDQ0FtZWdBd0lCQWdJQkFUQU5CZ2txaGtpRzl3MEJBUXNGQURBeU1SQXdEZ1lEVlFRS0RBZE5SVVF1ClQwNUZNUjR3SEFZRFZRUUREQlZEWlhKMGFXWnBZMkYwWlNCQmRYUm9iM0pwZEhrd0hoY05NakF3TXpFNE1URTAKTkRFMVdoY05OREF3TXpFNE1URTBOREUxV2pBeU1SQXdEZ1lEVlFRS0RBZE5SVVF1VDA1Rk1SNHdIQVlEVlFRRApEQlZEWlhKMGFXWnBZMkYwWlNCQmRYUm9iM0pwZEhrd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3CmdnRUtBb0lCQVFETXlOd3N5UXJhcS9YL3RGald6R2lyUGZrSzJXbE1QbHFuWFVWaUNtaXdic0xOZVFpTkFPQ3oKdVdNY0luNmFlb0kzSGNJWUlrMHNlRHh6NFlrUTdBZ2MzeSszeTZ3bkVaMGpQdzUyVEpkM0s1dXd1cEwwL01tcgpSU29KMGZ2UDN3akJLekJ5QlpQTS9sS0RTWVR2bndRUWRzSjBrMkc3OHZKWDVUQlhkMC9Hc0RlMmFTWFgwekNTCm05dzMvcER4aENlZTlBdmJJcTJjK3krZVQzaWhqSTdHZWh6RzVVWUc1Z1E0YmczeXQ2NTlKRXR5a0ZBTEdaN1QKWE9xanZQSHBKNWpMR3pzVG5icHRhOEFLTkpZeVZvSldZelk1WHh3anNMWUY0Y3BjYUdpR2RXQmpycVBoQ2xETApUWG9ENUJRTTNYM2I5bTFaVWpSb0NmMWdHQmlIYUxWL0FnTUJBQUdqZ1o4d2dad3dId1lEVlIwakJCZ3dGb0FVCm94MEpjSGQ3RlcvTXF5aFA3cFlZM0gyYUxaUXdEd1lEVlIwVEFRSC9CQVV3QXdFQi96QU9CZ05WSFE4QkFmOEUKQkFNQ0FjWXdIUVlEVlIwT0JCWUVGS01kQ1hCM2V4VnZ6S3NvVCs2V0dOeDltaTJVTURrR0NDc0dBUVVGQndFQgpCQzB3S3pBcEJnZ3JCZ0VGQlFjd0FZWWRhSFIwY0RvdkwybHdZUzFqWVM1dFpXUXViMjVsTDJOaEwyOWpjM0F3CkRRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFBZy9kSklzZmtIRmdSOVY0bGg1d3J1bllUS21CeXNDejFHRjU3MGYKUUEweXREN09ZS3ErZFJGdEFQU0RzR0dVV3loVGN5elZNVVV6YkphODZMMWljY1hwQXg2dHlkd09nNDZyQ1dBNwpKSmcwdEdSTTdiMEoxWmZaNjdZYmlVTGtKWXV0M0VkbmJGSlRpTk9saXdDL1Yxa2JiMGVaeDBJS0N1ZVFwSmYzCnpzU1pUTGRsZG9IQ24ra3M3ZklTVG8zbUJpa0ZRMklXSytTNmJtUWRyT0VBT2l0VStHNUFzQmlTVWNkUXZKd3QKLzhqRVZTR1p4cEN2bFF1R2VKaTFmakdZMlZDdXlsQkNaWUtkZmtRSGhkN0E0SHlZZHFEVmovL0lEdkZlN3RMRQpEendJUlBTa3FhaVdEWDFjd2Z3RWRBUnUwYllZdUZFMzFnbXpYWG1JclZFbmx6ND0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=")
			a.WithClusterName("medone-0")
			a.WithNamespace(namespace)
			a.WithDirName("testdata2")

			kcPath, err := NewKubeConfig(a)
			if err != nil {
				t.Fatal(err)
			}

			t.Logf("Path of the created KubeConfig file: %s", kcPath)
			return ctx
		}).Feature()

	testsEnvironment.Test(t, feat)
}
